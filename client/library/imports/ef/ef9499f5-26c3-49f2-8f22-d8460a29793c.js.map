{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\miniGame\\miniMain/assets\\script\\miniGame\\miniMain\\editFrame.js"],"names":["cc","Class","extends","Component","properties","nicknameLab","default","type","Label","tooltip","signatureBoxLab","signatureEditBoxLab","EditBox","bg","Node","avatarLayout","avatarPrefab","Prefab","onLoad","global","FitHelper","onEnable","node","fitFun","init","on","data","show","initData","fade","string","clientAttrData","nickname","signature","removeAllChildren","index","imageConf","avatar","instantiate","parent","emit","setPosition","v2","onButtonClick","target","children","getComponent","chosen","active","param","userId","userData","id","token","HttpHelper","httpPost","urlConf","set_signature","rsp","code","initClientAttrData","clientAttr","systemEvent","onCloseClick"],"mappings":";;;;;;AAAA;;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,qBAAa;AACTC,qBAAS,IADA;AAETC,kBAAMP,GAAGQ,KAFA;AAGTC,qBAAS;AAHA,SADL;AAMRC,yBAAiB;AACbJ,qBAAS,IADI;AAEbC,kBAAMP,GAAGQ,KAFI;AAGbC,qBAAS;AAHI,SANT;AAWRE,6BAAqB;AACjBL,qBAAS,IADQ;AAEjBC,kBAAMP,GAAGY,OAFQ;AAGjBH,qBAAS;AAHQ,SAXb;AAgBRI,YAAI;AACAP,qBAAS,IADT;AAEAC,kBAAMP,GAAGc,IAFT;AAGAL,qBAAS;AAHT,SAhBI;AAqBRM,sBAAc;AACVT,qBAAS,IADC;AAEVC,kBAAMP,GAAGc,IAFC;AAGVL,qBAAS;AAHC,SArBN;AA0BRO,sBAAc;AACVV,qBAAS,IADC;AAEVC,kBAAMP,GAAGiB,MAFC;AAGVR,qBAAS;AAHC;AA1BN,KAHP;;AAoCL;;AAEAS,UAtCK,oBAsCK;AAAA;;AACNC,yBAAOC,SAAP,CAAiBC,QAAjB,CAA0B,KAAKC,IAA/B;AACAH,yBAAOC,SAAP,CAAiBG,MAAjB,CAAwB,KAAKV,EAA7B;AACA,aAAKW,IAAL;;AAEA,aAAKF,IAAL,CAAUG,EAAV,CAAa,MAAb,EAAoB,UAACC,IAAD,EAAQ;AACxB,kBAAKC,IAAL;AACA,kBAAKC,QAAL;AACH,SAHD;;AAKA,aAAKN,IAAL,CAAUG,EAAV,CAAa,MAAb,EAAoB,UAACC,IAAD,EAAQ;AACxB,kBAAKG,IAAL;AACH,SAFD;AAGH,KAnDI;AAqDLL,QArDK,kBAqDC;AACF,aAAKI,QAAL;AACA,aAAKC,IAAL;AACH,KAxDI;AA0DLD,YA1DK,sBA0DK;AACN,aAAKvB,WAAL,CAAiByB,MAAjB,GAA0BX,iBAAOY,cAAP,CAAsBC,QAAhD;AACA,aAAKtB,eAAL,CAAqBoB,MAArB,GAA8BX,iBAAOY,cAAP,CAAsBE,SAApD;AACA,aAAKtB,mBAAL,CAAyBmB,MAAzB,GAAkCX,iBAAOY,cAAP,CAAsBE,SAAxD;AACA,aAAKlB,YAAL,CAAkBmB,iBAAlB;AACA,aAAI,IAAIC,KAAR,IAAiBhB,iBAAOiB,SAAP,CAAiBC,MAAlC,EACA;AACI,gBAAIA,SAASrC,GAAGsC,WAAH,CAAe,KAAKtB,YAApB,CAAb;AACAqB,mBAAOE,MAAP,GAAgB,KAAKxB,YAArB;AACAsB,mBAAOG,IAAP,CAAY,MAAZ,EAAmBL,KAAnB;AACH;AACJ,KArEI;AAuELR,QAvEK,kBAuEC;;AAEF,aAAKL,IAAL,CAAUmB,WAAV,CAAsBzC,GAAG0C,EAAH,CAAM,CAAN,EAAQ,CAAR,CAAtB;AACH,KA1EI;AA4ELb,QA5EK,kBA4EC;AACF;AACA,aAAKP,IAAL,CAAUmB,WAAV,CAAsBzC,GAAG0C,EAAH,CAAM,IAAN,EAAW,CAAX,CAAtB;AACH,KA/EI;AAiFLC,iBAjFK,yBAiFSC,MAjFT,EAiFgBlB,IAjFhB,EAiFqB;AAAA;;AACtB,YAAImB,WAAW,KAAK9B,YAAL,CAAkB8B,QAAjC;AACA,YAAIR,SAAS,CAAC,CAAd;AACA,aAAI,IAAIF,KAAR,IAAiBU,QAAjB,EACA;AACI,gBAAGA,SAASV,KAAT,EAAgBW,YAAhB,CAA6B,QAA7B,EAAuCC,MAAvC,CAA8CC,MAAjD,EACA;AACIX,yBAASF,KAAT;AACA;AACH;AACJ;;AAED,YAAIc,QAAQ;AACRhB,uBAAU,KAAKvB,eAAL,CAAqBoB,MADvB;AAERoB,oBAAO/B,iBAAOgC,QAAP,CAAgBC,EAFf;AAGRC,mBAAMlC,iBAAOgC,QAAP,CAAgBE,KAHd;AAIRhB,oBAAOA;AAJC,SAAZ;AAMAlB,yBAAOmC,UAAP,CAAkBC,QAAlB,CAA2BpC,iBAAOqC,OAAP,CAAeC,aAA1C,EAAwDR,KAAxD,EAA8D,UAACS,GAAD,EAAO;AACjE,gBAAGA,IAAIC,IAAJ,IAAY,GAAf,EACA;AACIxC,iCAAOY,cAAP,CAAsB6B,kBAAtB,CAAyCF,IAAIhC,IAAJ,CAASmC,UAAlD;AACA7D,mBAAG8D,WAAH,CAAetB,IAAf,CAAoB,gBAApB,EAAqC,EAArC;AACH;AACD,mBAAKX,IAAL;AACH,SAPD;AAQH,KA3GI;AA6GLkC,gBA7GK,wBA6GQnB,MA7GR,EA6GelB,IA7Gf,EA8GL;AACI,aAAKG,IAAL;AACH;AAhHI;;AAmHL;AAnHJ","file":"editFrame.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\miniGame\\miniMain","sourcesContent":["import global from \"./../../global/global\";\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        nicknameLab: {\r\n            default: null,\r\n            type: cc.Label,\r\n            tooltip: '昵称'\r\n        },\r\n        signatureBoxLab: {\r\n            default: null,\r\n            type: cc.Label,\r\n            tooltip: '个性签名'\r\n        },\r\n        signatureEditBoxLab: {\r\n            default: null,\r\n            type: cc.EditBox,\r\n            tooltip: '个性签名'\r\n        },\r\n        bg: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '背景'\r\n        },\r\n        avatarLayout: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '头像选择框'\r\n        },\r\n        avatarPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n            tooltip: '头像预制体'\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        global.FitHelper.onEnable(this.node);\r\n        global.FitHelper.fitFun(this.bg);\r\n        this.init();\r\n\r\n        this.node.on('show',(data)=>{\r\n            this.show();\r\n            this.initData();\r\n        });\r\n\r\n        this.node.on('fade',(data)=>{\r\n            this.fade();\r\n        });\r\n    },\r\n\r\n    init(){\r\n        this.initData();\r\n        this.fade();\r\n    },\r\n\r\n    initData(){\r\n        this.nicknameLab.string = global.clientAttrData.nickname;\r\n        this.signatureBoxLab.string = global.clientAttrData.signature;\r\n        this.signatureEditBoxLab.string = global.clientAttrData.signature;\r\n        this.avatarLayout.removeAllChildren();\r\n        for(var index in global.imageConf.avatar)\r\n        {\r\n            var avatar = cc.instantiate(this.avatarPrefab);\r\n            avatar.parent = this.avatarLayout;\r\n            avatar.emit('init',index);\r\n        }\r\n    },\r\n\r\n    show(){\r\n\r\n        this.node.setPosition(cc.v2(0,0));\r\n    },\r\n\r\n    fade(){\r\n        //global.FitHelper.onDisable();\r\n        this.node.setPosition(cc.v2(2000,0));\r\n    },\r\n\r\n    onButtonClick(target,data){\r\n        var children = this.avatarLayout.children;\r\n        var avatar = -1;\r\n        for(var index in children)\r\n        {\r\n            if(children[index].getComponent('avatar').chosen.active)\r\n            {\r\n                avatar = index;\r\n                break;\r\n            }\r\n        }\r\n        \r\n        var param = {\r\n            signature:this.signatureBoxLab.string,\r\n            userId:global.userData.id,\r\n            token:global.userData.token,\r\n            avatar:avatar\r\n        };\r\n        global.HttpHelper.httpPost(global.urlConf.set_signature,param,(rsp)=>{\r\n            if(rsp.code == 200)\r\n            {\r\n                global.clientAttrData.initClientAttrData(rsp.data.clientAttr);\r\n                cc.systemEvent.emit('updateUserInfo',{});\r\n            }\r\n            this.fade();\r\n        });\r\n    },\r\n\r\n    onCloseClick(target,data)\r\n    {\r\n        this.fade();\r\n    },\r\n\r\n\r\n    // update (dt) {},\r\n});\r\n"]}