{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\assets\\script\\miniGame\\miniMain\\prefab/assets\\script\\miniGame\\miniMain\\prefab\\avatar.js"],"names":["cc","Class","extends","Component","properties","avatar","default","type","Sprite","tooltip","chosen","Node","tag","Integer","onLoad","node","on","init","systemEvent","avatarChosen","onDestroy","off","start","isChosen","avatarUrl","global","imageConf","loader","load","url","error","purl","console","log","oldSize","width","spriteFrame","SpriteFrame","newSize","scale","clientAttrData","active","onButtonClick","target","data","emit"],"mappings":";;;;;;AAAA;;;;;;AACAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,gBAAO;AACHC,qBAAS,IADN;AAEHC,kBAAMP,GAAGQ,MAFN;AAGHC,qBAAS;AAHN,SADC;AAMRC,gBAAO;AACHJ,qBAAS,IADN;AAEHC,kBAAMP,GAAGW,IAFN;AAGHF,qBAAS;AAHN,SANC;AAWRG,aAAI;AACAN,qBAAS,CAAC,CADV;AAEAC,kBAAMP,GAAGa,OAFT;AAGAJ,qBAAS;AAHT;;AAXI,KAHP;;AAuBL;;AAEAK,UAzBK,oBAyBK;AACN,aAAKC,IAAL,CAAUC,EAAV,CAAa,MAAb,EAAoB,KAAKC,IAAzB,EAA8B,IAA9B;AACAjB,WAAGkB,WAAH,CAAeF,EAAf,CAAkB,cAAlB,EAAiC,KAAKG,YAAtC,EAAmD,IAAnD;AACH,KA5BI;AA8BLC,aA9BK,uBA8BM;AACPpB,WAAGkB,WAAH,CAAeG,GAAf,CAAmB,cAAnB,EAAkC,KAAKF,YAAvC,EAAoD,IAApD;AACH,KAhCI;AAkCLG,SAlCK,mBAkCI,CAER,CApCI;AAsCLL,QAtCK,gBAsCAL,GAtCA,EAsCI;AAAA;;AACL,aAAKA,GAAL,GAAWA,GAAX;AACA,aAAKW,QAAL;AACA,YAAIC,YAAYC,iBAAOC,SAAP,CAAiBrB,MAAjB,CAAwBO,GAAxB,CAAhB;AACAZ,WAAG2B,MAAH,CAAUC,IAAV,CAAe,EAAEC,KAAIL,SAAN,EAAiBjB,MAAM,KAAvB,EAAf,EAA+C,UAACuB,KAAD,EAAQC,IAAR,EAAiB;AAC5D,gBAAGD,KAAH,EAAS;AACLE,wBAAQC,GAAR,CAAYH,KAAZ;AACA;AACH;AACD,gBAAII,UAAU,MAAK7B,MAAL,CAAYU,IAAZ,CAAiBoB,KAA/B;AACA,kBAAK9B,MAAL,CAAY+B,WAAZ,GAA0B,IAAIpC,GAAGqC,WAAP,CAAmBN,IAAnB,CAA1B;AACA,gBAAIO,UAAU,MAAKjC,MAAL,CAAYU,IAAZ,CAAiBoB,KAA/B;AACA,kBAAK9B,MAAL,CAAYU,IAAZ,CAAiBwB,KAAjB,GAAyBL,UAAQI,OAAR,GAAgB,CAAzC;AACH,SATD;AAUH,KApDI;AAsDLf,YAtDK,sBAuDL;AACI,YAAG,KAAKX,GAAL,IAAYa,iBAAOe,cAAP,CAAsBnC,MAArC,EACA;AACI,iBAAKK,MAAL,CAAY+B,MAAZ,GAAqB,IAArB;AACH,SAHD,MAKI,KAAK/B,MAAL,CAAY+B,MAAZ,GAAqB,KAArB;AAEP,KA/DI;AAiELC,iBAjEK,yBAiESC,MAjET,EAiEgBC,IAjEhB,EAiEqB;AACtB5C,WAAGkB,WAAH,CAAe2B,IAAf,CAAoB,cAApB,EAAmC,KAAKjC,GAAxC;AACH,KAnEI;AAqELO,gBArEK,wBAqEQyB,IArER,EAsEL;AACI,YAAGA,QAAQ,KAAKhC,GAAhB,EACA;AACI,iBAAKF,MAAL,CAAY+B,MAAZ,GAAqB,IAArB;AACH,SAHD,MAKI,KAAK/B,MAAL,CAAY+B,MAAZ,GAAqB,KAArB;AACP;;AAED;;AA/EK,CAAT","file":"avatar.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\script\\miniGame\\miniMain\\prefab","sourcesContent":["import global from './../../../global/global'\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        avatar:{\r\n            default: null,\r\n            type: cc.Sprite,\r\n            tooltip: '头像'\r\n        },\r\n        chosen:{\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '被选中'\r\n        },\r\n        tag:{\r\n            default: -1,\r\n            type: cc.Integer,\r\n            tooltip: '标签'\r\n        },\r\n\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.node.on('init',this.init,this);\r\n        cc.systemEvent.on('avatarChosen',this.avatarChosen,this);\r\n    },\r\n\r\n    onDestroy(){\r\n        cc.systemEvent.off('avatarChosen',this.avatarChosen,this);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    init(tag){\r\n        this.tag = tag;\r\n        this.isChosen();\r\n        var avatarUrl = global.imageConf.avatar[tag];\r\n        cc.loader.load({ url:avatarUrl, type: 'png' }, (error, purl) => {\r\n            if(error){\r\n                console.log(error);\r\n                return;\r\n            }\r\n            let oldSize = this.avatar.node.width;\r\n            this.avatar.spriteFrame = new cc.SpriteFrame(purl)\r\n            let newSize = this.avatar.node.width;\r\n            this.avatar.node.scale = oldSize/newSize/2;\r\n        });\r\n    },\r\n\r\n    isChosen()\r\n    {\r\n        if(this.tag == global.clientAttrData.avatar)\r\n        {\r\n            this.chosen.active = true;\r\n        }\r\n        else\r\n            this.chosen.active = false;\r\n    \r\n    },\r\n\r\n    onButtonClick(target,data){\r\n        cc.systemEvent.emit('avatarChosen',this.tag);\r\n    },\r\n\r\n    avatarChosen(data)\r\n    {\r\n        if(data == this.tag)\r\n        {\r\n            this.chosen.active = true;\r\n        }\r\n        else\r\n            this.chosen.active = false;\r\n    }\r\n\r\n    // update (dt) {},\r\n});\r\n"]}