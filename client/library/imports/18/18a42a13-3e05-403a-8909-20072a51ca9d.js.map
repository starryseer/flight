{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\miniGame\\jumpBall/assets\\script\\miniGame\\jumpBall\\jumpBall.js"],"names":["cc","Class","extends","Component","properties","bg","default","type","Node","tooltip","ball","tipFrame","blockPrefab","Prefab","blockParent","score","Label","tag","Integer","onLoad","string","gameStart","blockSpeed","blockList","lastPos","global","FitHelper","fitFun","initPhysics","initBlock","node","on","acc","systemEvent","collider","onDestroy","off","manager","director","getPhysicsManager","enabled","gravity","v2","x","block","i","instantiate","parent","setPosition","push","getComponent","initSpeed","rigidBody","RigidBody","linearVelocity","parseInt","getLastPos","pos","update","dt","winSize","width","emit","y","max","HttpHelper","httpPost","urlConf","mini_play","userId","userData","id","token","gameId","point","rsp","code","clientAttrData","initClientAttrData","data","clientAttr","miniGameData","playData","miniGame","preloadScene","now"],"mappings":"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","file":"jumpBall.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\miniGame\\jumpBall","sourcesContent":["import global from \"./../../global/global\"\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        bg: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '背景'\r\n        },\r\n        ball: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '小球'\r\n        },\r\n        tipFrame: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '提示框'\r\n        },\r\n        blockPrefab: {\r\n            default: null,\r\n            type: cc.Prefab,\r\n            tooltip: '板'\r\n        },\r\n        blockParent: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '背景'\r\n        },\r\n        score: {\r\n            default: null,\r\n            type: cc.Label,\r\n            tooltip: '分数'\r\n        },\r\n        tag: {\r\n            default: 0,\r\n            type: cc.Integer,\r\n            tooltip: '标签'\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.score.string = 0;\r\n        this.gameStart = 0;\r\n        this.blockSpeed = 350;\r\n        this.blockList = [];\r\n        this.lastPos = null;\r\n\r\n        global.FitHelper.fitFun(this.bg);\r\n        this.initPhysics();\r\n        this.initBlock();\r\n        this.node.on('touchstart',this.acc,this);\r\n        cc.systemEvent.on('collider',this.collider,this);\r\n    },\r\n\r\n    onDestroy(){\r\n        this.node.off('touchstart',this.acc,this);\r\n        cc.systemEvent.off('collider',this.collider,this);\r\n    },\r\n\r\n    initPhysics:function(){\r\n        var manager = cc.director.getPhysicsManager();\r\n        manager.enabled = true;\r\n        manager.gravity = cc.v2(0,-2400);\r\n            \r\n    },\r\n\r\n    initBlock()\r\n    {\r\n        this.lastPos = cc.v2(this.ball.x,0);\r\n        var block = null;\r\n        for(var i = 0;i<6;i++)\r\n        {\r\n            block = cc.instantiate(this.blockPrefab);\r\n            block.parent = this.blockParent;\r\n            block.setPosition(this.lastPos);\r\n            this.blockList.push(block);\r\n            this.lastPos.x+=280;\r\n        } \r\n    },\r\n\r\n    acc(){\r\n        if(this.ball.getComponent('ball').initSpeed)\r\n        {\r\n            var rigidBody = this.ball.getComponent(cc.RigidBody);\r\n            rigidBody.linearVelocity = cc.v2(0,-1200);\r\n            if(this.gameStart == 0)\r\n                this.gameStart = 1;\r\n        }\r\n    },\r\n\r\n    collider(){\r\n        if(this.gameStart)\r\n        {\r\n            this.score.string = parseInt(this.score.string)+1;\r\n            this.blockSpeed+=5;\r\n        }\r\n\r\n    },\r\n\r\n    getLastPos(){\r\n        var pos = 0;\r\n        for(var block of this.blockList)\r\n        {\r\n            if(block.x > pos)\r\n                pos = block.x;\r\n        }\r\n        return pos;\r\n    },\r\n\r\n    update (dt) {\r\n        if(this.gameStart)\r\n        {\r\n            for(var block of this.blockList)\r\n            {\r\n                block.x+= (-1)*this.blockSpeed*dt;\r\n                if(block.x < ((-1)*cc.winSize.width/2 -280))\r\n                {\r\n                    block.x = this.getLastPos() + 280;\r\n                    block.emit('init',{});\r\n                }\r\n            }\r\n        }\r\n\r\n        if(this.ball.y <-200 && !this.tag)\r\n        {\r\n            this.tag = 1;\r\n            var max = global.HttpHelper.httpPost(global.urlConf.mini_play, {userId:global.userData.id,token:global.userData.token,gameId:1,point:this.score.string},\r\n                (rsp)=>{\r\n                    if(rsp == -1)\r\n                    {\r\n                        return;\r\n                    }\r\n\r\n                    if(rsp.code == 200)\r\n                    {\r\n                        global.clientAttrData.initClientAttrData(rsp.data.clientAttr);\r\n                        global.miniGameData.playData(rsp.data.miniGame);\r\n                        cc.director.preloadScene(\"miniMain\",()=>{\r\n                            this.tipFrame.emit('show',{now:this.score.string,max:global.miniGameData.miniGame[1]['point']});\r\n                        });\r\n   \r\n                    }\r\n                    else\r\n                    {\r\n                        return;\r\n                    }\r\n                });\r\n            \r\n        }\r\n \r\n\r\n    },\r\n});\r\n"]}