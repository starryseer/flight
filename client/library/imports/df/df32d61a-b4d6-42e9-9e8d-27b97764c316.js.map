{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\script\\home\\player/assets\\script\\home\\player\\player.js"],"names":["cc","Class","extends","Component","properties","moveDir","default","v2","displayName","tooltip","_speedType","JoystickEnum","SpeedType","STOP","type","_moveSpeed","stopSpeed","Integer","normalSpeed","fastSpeed","lock","onLoad","systemEvent","on","playerLock","playerUnLock","JoystickEvent","getInstance","JoystickEventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","onDestroy","off","event","data","speedType","moveDistance","move","delat","mul","node","getComponent","RigidBody","linearVelocity","x","y","update","dt","NORMAL","FAST"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\home\\player","sourcesContent":["import JoystickEnum from \"./../../helper/Joystick/JoystickEnum\";\nimport JoystickEvent from \"./../../helper/Joystick/JoystickEvent\";\nimport global from \"../../global/global\";\ncc.Class({\n    extends: cc.Component,\n    properties: {\n \n        // from joystick\n        moveDir: {\n            default: cc.v2(0, 1),\n            displayName: 'Move Dir',\n            tooltip: '移动方向',\n        },\n        _speedType: {\n            default: JoystickEnum.SpeedType.STOP,\n            displayName: 'Speed Type',\n            type: JoystickEnum.SpeedType,\n            tooltip: '速度级别'\n        },\n \n        // from self\n        _moveSpeed: {\n            default: 0,\n            displayName: 'Move Speed',\n            tooltip: '移动速度'\n        },\n \n        stopSpeed: {\n            default: 0,\n            type: cc.Integer,\n            tooltip: '停止时速度'\n        },\n        normalSpeed: {\n            default: 100,\n            type: cc.Integer,\n            tooltip: '正常速度'\n        },\n        fastSpeed: {\n            default: 200,\n            type: cc.Integer,\n            tooltip: '最快速度'\n        }, \n        lock: {\n            default: 0,\n            type: cc.Integer,\n            tooltip: '上锁'\n        }, \n    },\n\n    onLoad() {\n        cc.systemEvent.on('playerLock',this.playerLock,this);\n        cc.systemEvent.on('playerUnLock',this.playerUnLock,this);\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_START, this.onTouchStart, this);\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_MOVE, this.onTouchMove, this);\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_END, this.onTouchEnd, this);\n    },\n\n    onDestroy(){\n        cc.systemEvent.off('playerLock',this.playerLock,this);\n        cc.systemEvent.off('playerUnLock',this.playerUnLock,this);\n    },\n\n    playerLock(){\n        this.lock = 1;\n    },\n\n    playerUnLock(){\n        this.lock = 0;\n    },\n \n    onTouchStart() {\n \n    },\n \n    onTouchMove(event, data) {\n        this._speedType = data.speedType;\n        this.moveDir = data.moveDistance;\n    },\n \n    onTouchEnd(event, data) {\n        this._speedType = data.speedType;\n        \n    },\n \n    // methods\n    move() {\n //       this.node.angle = cc.misc.radiansToDegrees(\n //           Math.atan2(this.moveDir.y, this.moveDir.x)\n //       ) - 90;\n        // cc.log(this.moveDir.mul(this._moveSpeed / 120));\n        var delat = this.moveDir.mul(this._moveSpeed / 120);\n        this.node.getComponent(cc.RigidBody).linearVelocity = cc.v2(delat.x*120,delat.y*120);\n\n //       let newPos = this.node.position.add(this.moveDir.mul(this._moveSpeed / 120));\n //       this.node.setPosition(newPos);\n        \n    },\n \n\n\n    update(dt) {\n        if(!this.lock)\n        {\n            switch (this._speedType) {\n                case JoystickEnum.SpeedType.STOP:\n                    this._moveSpeed = this.stopSpeed;\n                    break;\n                case JoystickEnum.SpeedType.NORMAL:\n                    this._moveSpeed = this.normalSpeed;\n                    break;\n                case JoystickEnum.SpeedType.FAST:\n                    this._moveSpeed = this.fastSpeed;\n                    break;\n                default:\n                    break;\n            }\n            this.move();\n        }\n    },\n});\n \n"]}