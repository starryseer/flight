{"version":3,"sources":["trigger.js"],"names":["cc","Class","extends","Component","properties","triggerFrame","default","type","Node","tooltip","startTarggit","framePrefab","Prefab","triggerOther","frameAcitve","displayName","onLoad","active","anim_com","getComponent","Animation","onCollisionEnter","other","self","showFrame","tag","trigOther","updateScene","onCollisionExit","hideFrame","triggerConf","global","removeAllChildren","triggerPrefab","instantiate","parent","node","runAction","sequence","delayTime","callFunc","flag","emit"],"mappings":"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","file":"trigger.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\script\\home\\trigger","sourcesContent":["import global from \"./../../global/global\"\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        triggerFrame: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '角色想象框'\r\n        },\r\n        startTarggit: {\r\n            default: null,\r\n            type: cc.Node,\r\n            tooltip: '触发操作小手'\r\n        },\r\n        framePrefab:{\r\n            default: [],\r\n            type: cc.Prefab,\r\n            tooltip: '角色想象图标'\r\n        },\r\n        triggerOther:{\r\n            default: [],\r\n            type: cc.Node,\r\n            tooltip: '触发其他场景'\r\n        },\r\n        frameAcitve: {\r\n            default: false,\r\n            displayName: 'frameAcitve',\r\n            tooltip: '框是否激活',\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        // 隐藏节点\r\n        this.triggerFrame.active = false;\r\n        this.startTarggit.active = false;\r\n        this.anim_com = this.startTarggit.getComponent(cc.Animation);\r\n        \r\n    },\r\n\r\n    onCollisionEnter: function (other, self) {\r\n        this.showFrame(other.tag);\r\n        this.trigOther(other.tag,true);\r\n        this.updateScene(other.tag);\r\n    },\r\n    \r\n    onCollisionExit: function (other, self) {\r\n        this.startTarggit.active = false;\r\n        this.hideFrame();\r\n        this.trigOther(other.tag,false);\r\n        this.updateScene(null);\r\n    },\r\n\r\n    showFrame(tag){\r\n        var triggerConf = global.triggerConf[tag];\r\n        this.triggerFrame.removeAllChildren();\r\n        var triggerPrefab = cc.instantiate(this.framePrefab[triggerConf['frame']]);\r\n        triggerPrefab.parent = this.triggerFrame;\r\n        this.frameAcitve = true;\r\n        this.node.runAction(cc.sequence(cc.delayTime(0.2),cc.callFunc(()=>{\r\n            this.triggerFrame.active = this.frameAcitve;\r\n            this.startTarggit.active = this.frameAcitve;\r\n        })));\r\n    },\r\n\r\n    hideFrame()\r\n    {\r\n        this.frameAcitve = false;\r\n        this.triggerFrame.removeAllChildren();\r\n        this.triggerFrame.active = this.frameAcitve;\r\n        this.startTarggit.active = this.frameAcitve;\r\n    },\r\n\r\n    trigOther(tag,flag)\r\n    {\r\n        var triggerConf = global.triggerConf[tag];\r\n        if(triggerConf['other'] == null)\r\n            return;\r\n\r\n        //触发监听trigger事件\r\n        this.triggerOther[triggerConf['other']].emit('trigger',flag);\r\n    },\r\n\r\n    updateScene(tag)\r\n    {\r\n        if(tag == null)\r\n        {\r\n            this.startTarggit.emit(\"updateScene\",null);\r\n            return;\r\n        }\r\n\r\n        var triggerConf = global.triggerConf[tag];\r\n        this.startTarggit.emit(\"updateScene\",triggerConf['scene']);\r\n    }\r\n\r\n    // update (dt) {},\r\n});\r\n"]}